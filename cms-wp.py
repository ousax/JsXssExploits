import json
import sys
import os
import time
import re
import requests
from bs4 import BeautifulSoup as bs
from colorama import Fore
url = sys.argv[1] if len(sys.argv) > 1 else exit(Fore.RED+f"python {sys.argv[0]} wp-url pass_list [optional]"+Fore.RESET)
psswd = sys.argv[2] if len(sys.argv) > 2 and os.path.exists(psswd) else "n"
class CmsWP:
  def __init__(self, url, psswd): # logins 
    self.url, self.psswd = url , psswd
  def EnumerateUsers(self):
    # wp-json/wp/v2/users/1
    users_url = f'{url}/wp-json/wp/v2/users/'
    headers = {
      "User-Agent":"GoogleBot",
      "Accept":"*/*"
    }
    reqUsers = requests.get(users_url, headers=headers, timeout=5, allow_redirects=False)
    if reqUsers.ok:
      try:
        JSON = json.loads(reqUsers.text) # json loader::load => from a file; loads => from a string
        users_ = [_['name'] for _ in JSON if _['id'] != None]
        print(users_)
      
      except Exception as UsersError: # jsonError probably
        print(Fore.RED+f"UsersError: {UsersError}"+Fore.RESET)
        exit()
    else:
      print(reqUsers.status_code)
  def Login(self):
    pass
cmsWP = CmsWP(url, psswd)
cmsWP.EnumerateUsers()
cmsWP.Login()
